-- USERS
CREATE TABLE usuarios (
  id SERIAL PRIMARY KEY,
  nome TEXT NOT NULL,
  email TEXT NOT NULL UNIQUE,
  senha TEXT NOT NULL,
  criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- TRANSACOES
CREATE TABLE transacoes (
  id SERIAL PRIMARY KEY,
  descricao TEXT NOT NULL,
  valor NUMERIC(10,2) NOT NULL,
  tipo TEXT NOT NULL,
  user_id INTEGER NOT NULL,
  data TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES usuarios(id) ON DELETE CASCADE
);

-- METAS
CREATE TABLE metas (
  id SERIAL PRIMARY KEY,
  titulo VARCHAR(255) NOT NULL,
  valor_atual NUMERIC(10,2) NOT NULL CHECK (valor_atual >= 0),
  valor_alvo NUMERIC(10,2) NOT NULL CHECK (valor_alvo > 0),
  mes INTEGER NOT NULL CHECK (mes BETWEEN 1 AND 12),
  ano INTEGER NOT NULL CHECK (ano >= 2000),
  user_id INTEGER NOT NULL REFERENCES usuarios(id) ON DELETE CASCADE
);